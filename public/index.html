<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Service - –ú–∞–≥–∞–∑–∏–Ω —É—Å–ª—É–≥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            background: #f8f9fa;
        }
        
        .shop-header {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }
        
        .shop-info {
            background: white;
            padding: 15px;
            margin: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-size: 14px;
            line-height: 1.4;
        }
        
        .services-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .service-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .service-card:hover {
            transform: translateY(-2px);
        }
        
        .service-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        
        .service-price {
            color: #007bff;
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .service-article {
            color: #666;
            font-size: 14px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error {
            text-align: center;
            padding: 40px;
            color: #dc3545;
            background: white;
            margin: 20px;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="shop-header">
        <h1 id="shopName">Smart Service</h1>
        <p>–ú–∞–≥–∞–∑–∏–Ω —É—Å–ª—É–≥</p>
    </div>
    
    <div id="shopDetails" class="shop-info">
        –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–∞–≥–∞–∑–∏–Ω–µ...
    </div>
    
    <div class="services-container">
        <h2>–ù–∞—à–∏ —É—Å–ª—É–≥–∏</h2>
        <div id="servicesList" class="loading">
            –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥...
        </div>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞
        async function loadShopData() {
            try {
                console.log('üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞...');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞
                const settingsResponse = await fetch('/api/shop-settings');
                const settings = await settingsResponse.json();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
                document.getElementById('shopName').textContent = settings.shop_name || 'Smart Service';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–∞–≥–∞–∑–∏–Ω–µ
                const shopDetails = document.getElementById('shopDetails');
                shopDetails.innerHTML = `
                    ${settings.holder_name ? `<strong>–î–µ—Ä–∂–∞—Ç–µ–ª—å:</strong> ${settings.holder_name}<br>` : ''}
                    ${settings.inn ? `<strong>–ò–ù–ù:</strong> ${settings.inn}<br>` : ''}
                    ${settings.registration_address ? `<strong>–ê–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> ${settings.registration_address}<br>` : ''}
                    ${settings.organization_address ? `<strong>–ê–¥—Ä–µ—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:</strong> ${settings.organization_address}<br>` : ''}
                    ${settings.email ? `<strong>Email:</strong> ${settings.email}<br>` : ''}
                    ${settings.phone ? `<strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${settings.phone}` : ''}
                `;
                
                console.log('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —É—Å–ª—É–≥–∏
                const servicesResponse = await fetch('/api/services');
                const services = await servicesResponse.json();
                
                const servicesContainer = document.getElementById('servicesList');
                
                if (services.length === 0) {
                    servicesContainer.innerHTML = '<div class="error">–£—Å–ª—É–≥–∏ –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã</div>';
                    return;
                }
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —É—Å–ª—É–≥–∏
                servicesContainer.innerHTML = services.map(service => `
                    <div class="service-card">
                        ${service.image_url ? `<img src="${service.image_url}" class="service-image" alt="${service.name}">` : ''}
                        <h3>${service.name}</h3>
                        <div class="service-article">–ê—Ä—Ç–∏–∫—É–ª: ${service.article}</div>
                        <div class="service-price">${parseFloat(service.price).toFixed(2)} —Ä—É–±.</div>
                        ${service.description ? `<p>${service.description}</p>` : ''}
                        ${service.category_name ? `<div><small>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${service.category_name}</small></div>` : ''}
                    </div>
                `).join('');
                
                console.log('‚úÖ –£—Å–ª—É–≥–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', services.length);
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                
                document.getElementById('servicesList').innerHTML = `
                    <div class="error">
                        –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.
                    </div>
                `;
            }
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        document.addEventListener('DOMContentLoaded', loadShopData);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(loadShopData, 30000);
    </script>
</body>
</html>
