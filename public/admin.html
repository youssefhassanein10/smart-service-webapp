<form id="productForm" enctype="multipart/form-data">
  <input type="hidden" name="id">
  <div class="mb-3"><label class="form-label">Название</label><input type="text" class="form-control" name="title" required></div>
  <div class="mb-3"><label class="form-label">Описание</label><textarea class="form-control" name="description"></textarea></div>
  <div class="mb-3"><label class="form-label">Цена</label><input type="number" class="form-control" name="price" required></div>
  <div class="mb-3"><label class="form-label">Фото товара</label><input type="file" class="form-control" name="image"></div>
  <div class="mb-3"><label class="form-label">Категория</label><select class="form-select" name="category_id"></select></div>
  <button type="submit" class="btn btn-primary w-100">Сохранить</button>
</form>

<script>
document.getElementById('productForm').addEventListener('submit', async e => {
  e.preventDefault();
  const form = e.target;
  const formData = new FormData(form); // включает файл
  const id = form.id.value;
  const url = id ? `/api/products/${id}` : '/api/products';
  const method = id ? 'PUT' : 'POST';
  
  await fetch(url, {
    method,
    headers: { 'x-admin-token': 'SUPER_SECRET_TOKEN' },
    body: formData
  });
  
  form.reset();
  productModal.hide();
  loadProducts(); // обновляем список
});
</script>
