keyboard.add(
    InlineKeyboardButton("‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä", callback_data="admin_add_product"),
    InlineKeyboardButton("üìã –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤", callback_data="admin_list_products"),
    InlineKeyboardButton("üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", callback_data="admin_stats"),
    InlineKeyboardButton("üîô –ù–∞–∑–∞–¥", callback_data="menu_main")
)
@dp.callback_query_handler(lambda c: c.data == "admin_add_product")
async def start_add_product(call: types.CallbackQuery):
    await ProductStates.waiting_for_article.set()
    await call.message.answer("–í–≤–µ–¥–∏—Ç–µ –∞—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞:")
    @dp.message_handler(state=ProductStates.waiting_for_article)
async def process_article(message: types.Message, state: FSMContext):
    async with state.proxy() as data:
        data['article'] = message.text
    await ProductStates.next()
    await message.answer("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:")
@dp.message_handler(state=ProductStates.waiting_for_name)
async def process_name(message: types.Message, state: FSMContext):
    async with state.proxy() as data:
        data['name'] = message.text
    await ProductStates.next()
    await message.answer("–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:")
# ... –∏ —Ç–∞–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è
@dp.message_handler(state=ProductStates.waiting_for_photo, content_types=['text', 'photo'])
async def process_photo(message: types.Message, state: FSMContext):
    async with state.proxy() as data:
        # –ï—Å–ª–∏ –ø—Ä–∏—Å–ª–∞–ª–∏ —Ñ–æ—Ç–æ, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å URL)
        if message.photo:
            # –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ (—Å–∞–º–æ–µ –±–æ–ª—å—à–æ–µ) —Ñ–æ—Ç–æ
            photo = message.photo[-1]
            # –ó–¥–µ—Å—å –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–æ—Ç–æ –∏ –ø–æ–ª—É—á–∏—Ç—å URL. –ü–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∞.
            data['photo_url'] = "https://via.placeholder.com/300x200.png?text=–¢–æ–≤–∞—Ä"
        else:
            data['photo_url'] = message.text if message.text else "https://via.placeholder.com/300x200.png?text=–¢–æ–≤–∞—Ä"

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–≤–∞—Ä –≤ –±–∞–∑—É
        add_product(
            article=data['article'],
            name=data['name'],
            description=data['description'],
            price=data['price'],
            old_price=data.get('old_price'),
            category=data.get('category'),
            stock=data.get('stock', 0),
            photo_url=data['photo_url']
        )

        await message.answer(f"–¢–æ–≤–∞—Ä {data['name']} —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!")
        await state.finish()
        
